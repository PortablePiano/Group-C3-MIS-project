import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.Scanner;

public class RiderList {

	public static void addRider() throws SQLException {
		//addRider - add a rider to array
		try (Connection conn = SimpleDataSource.getConnection()){
			Statement stat=conn.createStatement();
			Scanner in = new Scanner(System.in);
			System.out.println("insert phone number (xxx-xxx-xxxx)");
			String phone = in.next();
			System.out.println("insert name");
			String name = in.next();
			System.out.println("insert credit card (xxxx-xxxx-xxxx-xxxx)");
			String creditCard = in.next();
			String stmt = "INSERT INTO AllRiders VALUES '" + phone + "', '" + name + "', '" + creditCard + "'"; 
			stat.execute(stmt);
			in.close();
			}
		}

	public static void removeRider(String phone) throws SQLException{	
	//removeRider - remove rider from array
		try (Connection conn = SimpleDataSource.getConnection()){
			Statement stat=conn.createStatement();
			String stmt = "DELETE FROM AllRiders WHERE Phone = '" + phone + "'"; 
			//phone is given in AppMain
			stat.execute(stmt);
		}
	}

	public static void listRider() throws SQLException{
	//listRider - lists all rider in system
		try (Connection conn = SimpleDataSource.getConnection()){
			Statement stat= conn.createStatement();
			String stmt = "SELECT Name FROM AllRiders";
			boolean hasResultSet = stat.execute(stmt);
			if (hasResultSet){
				ResultSet result = stat.executeQuery(stmt);
				for (int i = 0; result.next(); i++) {          			          
					System.out.printf("%15s\n",result.getString(i)); //Print one element of a row
				}
			}else{
				System.out.println("riders not found");
			}
		}
	}


	public static String findRider(String phone) throws SQLException{
	//findRider - find a rider name by using their customer ID
		try (Connection conn = SimpleDataSource.getConnection()){
			Statement stat=conn.createStatement();
			String stmt = "SELECT Name FROM AllRiders WHERE Phone = '" + phone + "'"; 
			//phone is given in AppMain
			boolean hasResultSet = stat.execute(stmt);
			if (hasResultSet){
				ResultSet result = stat.executeQuery(stmt);
				return(result.getString(0));//maybe 1??
			}else{
				return("No rider found.");
			}
		}	
	}
	
	public static boolean isRider(String phone) throws SQLException {
		try (Connection conn = SimpleDataSource.getConnection()){
			Statement stat= conn.createStatement();
			String stmt = "SELECT * FROM AllRiders WHERE Phone = " + phone; 
			boolean hasResultSet = stat.execute(stmt);
			if (hasResultSet){
				return true;
			}else{
				return false;
			}
		}
	}
	
	
}
